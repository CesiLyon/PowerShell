<!DOCTYPE html>
<html>
<head>
<title>reponse.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="powershell">PowerShell</h1>
<p>Membres du groupe :</p>
<ul>
<li>Josselin (GMSI) ;</li>
<li>Sylvain (GMSI) ;</li>
<li>Florent (GMSI) ;</li>
<li>Mathis (DI).</li>
</ul>
<h2 id="question-1">Question 1</h2>
<p><strong>Donnez 7 caractéristiques d'une variable en programmation (pas uniquement PowerShell, mais programmation en général).</strong></p>
<ol>
<li>
<p>Nom</p>
<pre><code> C'est le nom de la variable, il doit être unique dans sa portée, ne pas commencer par un chiffre, ne pas contenir d'espace et ne pas être un mot réservé du langage. En fonction du langage, il peut être sensible à la casse.
</code></pre>
</li>
<li>
<p>Type</p>
<pre><code> C'est le type de la variable, il peut être de type primitif (entier, flottant, booléen, caractère, chaîne de caractères) ou de type complexe (tableau, liste, dictionnaire, objet, etc.). En fonction du langage, il peut être implicite ou explicite.
</code></pre>
</li>
<li>
<p>Valeur</p>
<pre><code> C'est la valeur dans la case mémoire de la variable, elle peut être modifiée directement ou indirectement en fonction du langage.
</code></pre>
</li>
<li>
<p>Portée</p>
<pre><code> C'est la zone du programme dans laquelle la variable est accessible, elle peut être globale (accessible partout), locale (accessible uniquement dans une fonction, une classe ou une boucle). Dans le cas d'un langage orienté objet, la portée peut être privée (accessible uniquement dans la classe), protégée (accessible dans la classe et ses enfants) ou publique (accessible partout).
</code></pre>
</li>
<li>
<p>Durée de vie</p>
<pre><code> C'est la durée pendant laquelle la variable est accessible, elle peut être temporaire (accessible uniquement dans une fonction, une classe ou une boucle) ou permanente (accessible partout). Dans certains langages, la durée de vie peut être définie par l'utilisateur, tandis que dans d'autres, elle est définie par le langage, et celui-ci se charge de la gestion de la mémoire. En java, le garbage collector se charge de la gestion de la mémoire en supprimant les variables inutilisées.
</code></pre>
</li>
<li>
<p>Mutabilité</p>
<pre><code> C'est la possibilité de modifier la valeur de la variable, elle peut être mutable (modifiable) ou immuable (non modifiable). En fonction du langage, la mutabilité peut être définie par l'utilisateur ou par le langage. Une variable immuable est appelée constante et ne peut être modifiée après son initialisation.
</code></pre>
</li>
<li>
<p>Initialisation</p>
<pre><code> C'est la valeur initiale de la variable, elle peut être définie par l'utilisateur ou par le langage. En fonction du langage, la variable peut être initialisée à sa déclaration ou à un autre moment. Par exemple, en java, l'attribut d'une classe peut être initialisé dans le constructeur de la classe, mais déclaré en dehors.
</code></pre>
</li>
</ol>
<h2 id="question-2">Question 2</h2>
<p><strong>Goal : Afficher des variables</strong></p>
<p><a href="https://github.com/Twiloo/PowerShell/blob/main/scripts/question2.ps1">Script question 2</a></p>
<pre class="hljs"><code><div><span class="hljs-variable">$nomUtilisateur</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-Prompt</span> <span class="hljs-string">"Veuillez saisir votre prenom"</span>

<span class="hljs-variable">$ageUtilisateur</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-Prompt</span> <span class="hljs-string">"Veuillez saisir votre age"</span>

<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Bonjour <span class="hljs-variable">$nomUtilisateur</span>, vous avez <span class="hljs-variable">$ageUtilisateur</span> ans."</span>
</div></code></pre>
<h2 id="question-3">Question 3</h2>
<p><strong>Goal : Jeu du nombre secret</strong></p>
<p><a href="https://github.com/Twiloo/PowerShell/blob/main/scripts/question3.ps1">Script question 3</a></p>
<pre class="hljs"><code><div><span class="hljs-variable">$nombreSecret</span> = <span class="hljs-built_in">Get-Random</span> <span class="hljs-literal">-Minimum</span> <span class="hljs-number">0</span> <span class="hljs-literal">-Maximum</span> <span class="hljs-number">101</span>

<span class="hljs-variable">$nombreEssais</span> = <span class="hljs-number">0</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-Essai</span></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Read-Host</span> <span class="hljs-string">"Devinez le nombre (entre 0 et 100)"</span>
}

<span class="hljs-keyword">do</span> {
    <span class="hljs-variable">$essaiUtilisateur</span> = <span class="hljs-built_in">Get-Essai</span>
    <span class="hljs-variable">$nombreEssais</span>++

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$essaiUtilisateur</span> <span class="hljs-operator">-gt</span> <span class="hljs-variable">$nombreSecret</span>) {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Trop haut ! Mon nombre est plus bas."</span> <span class="hljs-literal">-ForegroundColor</span> Red
    }
    <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$essaiUtilisateur</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$nombreSecret</span>) {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Trop bas ! Mon nombre est superieur."</span> <span class="hljs-literal">-ForegroundColor</span> Blue
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Bravo, vous avez trouve en <span class="hljs-variable">$nombreEssais</span> essais !"</span> <span class="hljs-literal">-ForegroundColor</span> Green
    }
} <span class="hljs-keyword">while</span> (<span class="hljs-variable">$essaiUtilisateur</span> <span class="hljs-operator">-ne</span> <span class="hljs-variable">$nombreSecret</span>)
</div></code></pre>
<h2 id="question-4">Question 4</h2>
<p><strong>Goal : Lancer notepad si ce n'est pas déjà fait</strong></p>
<p><a href="https://github.com/Twiloo/PowerShell/blob/main/scripts/question4.ps1">Script question 4</a></p>
<pre class="hljs"><code><div><span class="hljs-variable">$notepadProcess</span> = <span class="hljs-built_in">Get-Process</span> <span class="hljs-literal">-Name</span> notepad <span class="hljs-literal">-ErrorAction</span> SilentlyContinue

<span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> <span class="hljs-variable">$notepadProcess</span>) {
    <span class="hljs-built_in">Start-Process</span> notepad
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Notepad a ete lance."</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Notepad est deja en cours d'execution."</span>
}
</div></code></pre>
<h2 id="question-5">Question 5</h2>
<p><strong>Goal : Créer un utilisateur local administrateur et un utilisateur local non administrateur (puis les supprimer)</strong></p>
<p><a href="https://github.com/Twiloo/PowerShell/blob/main/scripts/question5.ps1">Script question 5</a></p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test-AdminPrivileges</span></span> {
    <span class="hljs-variable">$currentUser</span> = <span class="hljs-built_in">New-Object</span> Security.Principal.WindowsPrincipal([<span class="hljs-type">Security.Principal.WindowsIdentity</span>]::GetCurrent())
    <span class="hljs-variable">$adminRole</span> = [<span class="hljs-type">Security.Principal.WindowsBuiltInRole</span>]::Administrator
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$currentUser</span>.IsInRole(<span class="hljs-variable">$adminRole</span>)
}

<span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Test-AdminPrivileges</span>)) {
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Le script doit etre execute en tant qu'administrateur. Veuillez relancer le script en tant qu'administrateur."</span>
    <span class="hljs-variable">$null</span> = <span class="hljs-variable">$Host</span>.UI.RawUI.ReadKey(<span class="hljs-string">"NoEcho,IncludeKeyDown"</span>)
    <span class="hljs-keyword">Exit</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Write-LocaleUserAccount</span></span> {
    <span class="hljs-keyword">param</span>([<span class="hljs-built_in">string</span>]<span class="hljs-variable">$moment</span> = <span class="hljs-string">"actuellement"</span>)
    <span class="hljs-variable">$comptesLocaux</span> = <span class="hljs-built_in">Get-WmiObject</span> Win32_UserAccount | <span class="hljs-built_in">Where-Object</span> { <span class="hljs-variable">$_</span>.LocalAccount <span class="hljs-operator">-eq</span> <span class="hljs-variable">$true</span> }

    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Comptes utilisateurs locaux <span class="hljs-variable">$moment</span> :"</span>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$compte</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$comptesLocaux</span>) {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$compte</span>.Name
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-SecurePassword</span></span> {
    <span class="hljs-variable">$securePassword</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-Prompt</span> <span class="hljs-string">"Entrez le mot de passe"</span> <span class="hljs-literal">-AsSecureString</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$securePassword</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Compare-Password</span></span> {
    <span class="hljs-keyword">param</span>([<span class="hljs-type">System.Security.SecureString</span>]<span class="hljs-variable">$password</span>, [<span class="hljs-type">System.Security.SecureString</span>]<span class="hljs-variable">$verifyPassword</span>)
    <span class="hljs-keyword">return</span> [<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAuto([<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::SecureStringToBSTR(<span class="hljs-variable">$password</span>)) <span class="hljs-operator">-eq</span> [<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAuto([<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::SecureStringToBSTR(<span class="hljs-variable">$verifyPassword</span>))
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">New-Account</span></span> {
    <span class="hljs-keyword">param</span>([<span class="hljs-built_in">bool</span>]<span class="hljs-variable">$isAdmin</span> = <span class="hljs-variable">$false</span>)
    <span class="hljs-variable">$login</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-Prompt</span> <span class="hljs-string">"Entrez le login du nouveau compte"</span>
    <span class="hljs-variable">$password</span> = <span class="hljs-built_in">Get-SecurePassword</span>
    <span class="hljs-variable">$verifyPassword</span> = <span class="hljs-variable">$null</span>
    <span class="hljs-keyword">do</span> {
        <span class="hljs-variable">$verifyPassword</span> = <span class="hljs-built_in">Get-SecurePassword</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Compare-Password</span> <span class="hljs-literal">-password</span> <span class="hljs-variable">$password</span> <span class="hljs-literal">-verifyPassword</span> <span class="hljs-variable">$verifyPassword</span>)) {
            <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Les mots de passe ne correspondent pas. Veuillez reessayer."</span>
        }
    } <span class="hljs-keyword">while</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Compare-Password</span> <span class="hljs-literal">-password</span> <span class="hljs-variable">$password</span> <span class="hljs-literal">-verifyPassword</span> <span class="hljs-variable">$verifyPassword</span>))

    <span class="hljs-built_in">New-LocalUser</span> <span class="hljs-literal">-Name</span> <span class="hljs-variable">$login</span> <span class="hljs-literal">-Password</span> <span class="hljs-variable">$password</span> <span class="hljs-literal">-PasswordNeverExpires</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isAdmin</span>) {
        <span class="hljs-built_in">Add-LocalGroupMember</span> <span class="hljs-literal">-Group</span> <span class="hljs-string">"Administrateurs"</span> <span class="hljs-literal">-Member</span> <span class="hljs-variable">$login</span>
    }
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Nouveau compte <span class="hljs-variable">$</span>('non ' * (-not <span class="hljs-variable">$isAdmin</span>))administrateur '<span class="hljs-variable">$login</span>' cree."</span>

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$login</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Remove-Account</span></span> {
    <span class="hljs-keyword">param</span>([<span class="hljs-built_in">string</span>]<span class="hljs-variable">$login</span>)
    <span class="hljs-built_in">Remove-LocalUser</span> <span class="hljs-literal">-Name</span> <span class="hljs-variable">$login</span>
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Compte '<span class="hljs-variable">$login</span>' supprime."</span>
}

<span class="hljs-built_in">Write-LocaleUserAccount</span>
<span class="hljs-variable">$loginAdmin</span> = <span class="hljs-built_in">New-Account</span> <span class="hljs-literal">-isAdmin</span> <span class="hljs-variable">$true</span>
<span class="hljs-built_in">Write-LocaleUserAccount</span> <span class="hljs-string">"apres creation compte admin"</span>
<span class="hljs-variable">$loginNonAdmin</span> = <span class="hljs-built_in">New-Account</span>
<span class="hljs-built_in">Write-LocaleUserAccount</span> <span class="hljs-string">"apres creation compte non admin"</span>
<span class="hljs-built_in">Remove-Account</span> <span class="hljs-literal">-login</span> <span class="hljs-variable">$loginAdmin</span>
<span class="hljs-built_in">Write-LocaleUserAccount</span> <span class="hljs-string">"apres suppression compte admin"</span>
<span class="hljs-built_in">Remove-Account</span> <span class="hljs-literal">-login</span> <span class="hljs-variable">$loginNonAdmin</span>
<span class="hljs-built_in">Write-LocaleUserAccount</span> <span class="hljs-string">"apres suppression compte non admin"</span>
</div></code></pre>
<h2 id="question-6">Question 6</h2>
<p><strong>Goal : Trier les fichiers d'un dossier dans des dossiers par extension de fichier</strong></p>
<p><a href="https://github.com/Twiloo/PowerShell/blob/main/scripts/question6.ps1">Script question 6</a></p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-Folder</span></span> {
    <span class="hljs-keyword">param</span>([<span class="hljs-built_in">String</span>]<span class="hljs-variable">$relativePath</span> = <span class="hljs-string">""</span>)
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">Join-Path</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$PSScriptRoot</span> <span class="hljs-literal">-ChildPath</span> <span class="hljs-variable">$relativePath</span>)
}

<span class="hljs-variable">$folder</span> = <span class="hljs-built_in">Get-Folder</span> <span class="hljs-literal">-relativePath</span> <span class="hljs-string">"../files-to-sort"</span>
<span class="hljs-variable">$destination</span> = <span class="hljs-built_in">Get-Folder</span> <span class="hljs-literal">-relativePath</span> <span class="hljs-string">"../sorted-files"</span>

<span class="hljs-variable">$files</span> = <span class="hljs-built_in">Get-ChildItem</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$folder</span> <span class="hljs-operator">-File</span>

<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$file</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$files</span>) {
    <span class="hljs-variable">$fileExtension</span> = <span class="hljs-variable">$file</span>.Extension
    <span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">"<span class="hljs-variable">$destination</span>\<span class="hljs-variable">$fileExtension</span>"</span>)) {
        <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">"<span class="hljs-variable">$destination</span>\<span class="hljs-variable">$fileExtension</span>"</span> <span class="hljs-literal">-ItemType</span> Directory
    }
    <span class="hljs-built_in">Copy-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$file</span>.FullName <span class="hljs-literal">-Destination</span> <span class="hljs-string">"<span class="hljs-variable">$destination</span>\<span class="hljs-variable">$fileExtension</span>"</span>
}

<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Copie terminee."</span>
</div></code></pre>

</body>
</html>
